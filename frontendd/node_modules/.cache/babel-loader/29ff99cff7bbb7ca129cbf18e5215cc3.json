{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/Bastian/Desktop/Chat_App/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _asyncToGenerator from\"C:/Users/Bastian/Desktop/Chat_App/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Bastian/Desktop/Chat_App/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject;import _regeneratorRuntime from\"C:\\\\Users\\\\Bastian\\\\Desktop\\\\Chat_App\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import styled from'styled-components';import loader from'../assets/loader.gif';import{ToastContainer,toast}from'react-toastify';import\"react-toastify/dist/ReactToastify.css\";import axios from'axios';import{setAvatarRoute}from'../utils/APIRoutes';import{Buffer}from'buffer';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SetAvatar=function SetAvatar(){var api=\"https://api.multiavatar.com/45678945\";var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),avatars=_useState2[0],setAvatars=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),selectedAvatar=_useState6[0],setSelectedAvatar=_useState6[1];var toastOptions={position:\"bottom-right\",autoClose:8000,pauseOnHover:true,draggable:true,theme:\"dark\"};var setProfilePicture=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var user,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(selectedAvatar===undefined)){_context.next=4;break;}toast.error(\"Please select an avatar\",toastOptions);_context.next=13;break;case 4:_context.next=6;return JSON.parse(localStorage.getItem(\"chat-app-user\"));case 6:user=_context.sent;_context.next=9;return axios.post(\"\".concat(setAvatarRoute,\"/\").concat(user._id),{image:avatars[selectedAvatar]});case 9:_yield$axios$post=_context.sent;data=_yield$axios$post.data;console.log(data);if(data.isSet){user.isAvatarImageSet=true;user.avatarImage=data.image;localStorage.setItem(\"chat-app-user\",JSON.stringify(user));navigate(\"/\");}else{toast.error(\"Error setting avatar. Please try again\",toastOptions);}case 13:case\"end\":return _context.stop();}}},_callee);}));return function setProfilePicture(){return _ref.apply(this,arguments);};}();useEffect(function(){if(!localStorage.getItem(\"chat-app-user\")){navigate(\"/login\");}var fetchImage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data,i,image,buffer;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data=[];i=0;case 2:if(!(i<4)){_context2.next=11;break;}_context2.next=5;return axios.get(\"\".concat(api,\"/\").concat(Math.round(Math.random()*1000)));case 5:image=_context2.sent;buffer=new Buffer(image.data);data.push(buffer.toString(\"base64\"));case 8:i++;_context2.next=2;break;case 11:setAvatars(data);setIsLoading(false);case 13:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchImage(){return _ref2.apply(this,arguments);};}();fetchImage();},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[isLoading?/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(\"img\",{src:loader,alt:\"loader\",className:\"loader\"})}):/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-container\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Pick an avatar as yout profile picture\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"avatars\",children:avatars.map(function(avatar,index){return/*#__PURE__*/_jsx(\"div\",{className:\"avatar \".concat(selectedAvatar===index?\"selected\":\"\"),children:/*#__PURE__*/_jsx(\"img\",{src:\"data:image/svg+xml;base64, \".concat(avatar),alt:\"avatar\",onClick:function onClick(){return setSelectedAvatar(index);}})},index);})}),/*#__PURE__*/_jsx(\"button\",{className:\"submit-btn\",onClick:setProfilePicture,children:\"Set as Profile Piture\"})]}),/*#__PURE__*/_jsx(ToastContainer,{})]});};var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex:\\n  justify-content: center;\\n  align-items:center;\\n  flex-direction: column;\\n  gap: 3rem;\\n  background-color: #131324;\\n  height:100vh;\\n  width:100vw;\\n  .loader{\\n      max-line-size:100%\\n  }\\n  .title-container{\\n      h1{\\n          color:white\\n      }\\n  }\\n  .avatars{\\n      display:flex;\\n      gap: 2rem;\\n      .avatar{\\n          border: 0.4rem solid transparent;\\n          padding: 0.4rem;\\n          border-radius: 5rem;\\n          display:flex;\\n          justify-content:center;\\n          align-items:center;\\n          transition:0.5s ease-in-out;\\n          img{\\n            height: 6rem;\\n          }\\n      }\\n      .selected{\\n          border: 0.4rem solid #4e0eff;\\n      }\\n  }\\n  .submit-btn{\\n            background-color: #997af0;\\n            color: white;\\n            padding: 1rem 2rem;\\n            border:none ;\\n            font-weight: bold;\\n            cursor:pointer;\\n            border-radius: 0.4rem;\\n            font-size:1rem;\\n            text-transform: uppercase;\\n            transition: 0.5s ease-in-out;\\n            &:hover{\\n                background-color: #4e0eff;\\n            }\\n  }\\n\"])));export default SetAvatar;","map":{"version":3,"sources":["C:/Users/Bastian/Desktop/Chat_App/frontend/src/pages/SetAvatar.jsx"],"names":["React","useState","useEffect","useNavigate","styled","loader","ToastContainer","toast","axios","setAvatarRoute","Buffer","SetAvatar","api","navigate","avatars","setAvatars","isLoading","setIsLoading","undefined","selectedAvatar","setSelectedAvatar","toastOptions","position","autoClose","pauseOnHover","draggable","theme","setProfilePicture","error","JSON","parse","localStorage","getItem","user","post","_id","image","data","console","log","isSet","isAvatarImageSet","avatarImage","setItem","stringify","fetchImage","i","get","Math","round","random","buffer","push","toString","map","avatar","index","Container","div"],"mappings":"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","sourcesContent":["import React,{useState, useEffect} from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport styled from 'styled-components';\r\nimport loader from '../assets/loader.gif';\r\nimport {ToastContainer, toast} from 'react-toastify';\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport axios from 'axios';\r\nimport { setAvatarRoute } from '../utils/APIRoutes';\r\nimport {Buffer} from 'buffer';\r\n\r\nconst SetAvatar = () => {\r\n    const api = \"https://api.multiavatar.com/45678945\";\r\n    const navigate = useNavigate();\r\n    const [avatars, setAvatars] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [selectedAvatar, setSelectedAvatar] = useState(undefined);\r\n    const toastOptions = {\r\n        position: \"bottom-right\",\r\n        autoClose: 8000,\r\n        pauseOnHover: true,\r\n        draggable: true,\r\n        theme: \"dark\"\r\n    };\r\n    const setProfilePicture = async()=>{\r\n        if(selectedAvatar === undefined){\r\n            toast.error(\"Please select an avatar\", toastOptions)\r\n        }else{\r\n            const user = await JSON.parse(localStorage.getItem(\"chat-app-user\"))\r\n            const {data} = await axios.post(`${setAvatarRoute}/${user._id}`,{\r\n                image: avatars[selectedAvatar]\r\n            });\r\n            console.log(data);\r\n            if(data.isSet){\r\n                user.isAvatarImageSet = true;\r\n                user.avatarImage = data.image;\r\n                localStorage.setItem(\"chat-app-user\", JSON.stringify(user));\r\n                navigate(\"/\")\r\n            }else{\r\n                toast.error(\"Error setting avatar. Please try again\", toastOptions)\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    useEffect(()=>{\r\n        if(!localStorage.getItem(\"chat-app-user\")){\r\n            navigate(\"/login\")\r\n        }\r\n        const fetchImage = async()=>{\r\n            const data = [];\r\n            for(let i=0; i<4; i++){\r\n                const image = await axios.get(\r\n                    `${api}/${Math.round(Math.random()*1000)}`\r\n                );\r\n                const buffer = new Buffer(image.data);\r\n                data.push(buffer.toString(\"base64\"))\r\n            }\r\n            setAvatars(data);\r\n            setIsLoading(false);\r\n        }\r\n        fetchImage();\r\n    },[])\r\n\r\n  return (\r\n    <>\r\n    {\r\n        isLoading ? <Container>\r\n            <img src={loader} alt=\"loader\" className=\"loader\"/>\r\n        </Container> :(\r\n             <Container>\r\n                <div className=\"title-container\">\r\n                    <h1>Pick an avatar as yout profile picture</h1>\r\n                </div>\r\n                <div className=\"avatars\">\r\n                    {avatars.map((avatar, index)=>{\r\n                        return(\r\n                            <div\r\n                            key={index}\r\n                            className={`avatar ${\r\n                                selectedAvatar === index ? \"selected\" : \"\"\r\n                            }`}\r\n                            >\r\n                            <img\r\n                                src={`data:image/svg+xml;base64, ${avatar}`}\r\n                                alt=\"avatar\"\r\n                                onClick={()=>setSelectedAvatar(index)}\r\n                            />  \r\n                            </div>\r\n                        )\r\n                    })}\r\n                </div>\r\n                    <button className='submit-btn' onClick={setProfilePicture}>\r\n                        Set as Profile Piture\r\n                    </button>\r\n            </Container>\r\n        )}\r\n        <ToastContainer/>\r\n    </>\r\n  )\r\n}\r\nconst Container = styled.div`\r\n  display: flex:\r\n  justify-content: center;\r\n  align-items:center;\r\n  flex-direction: column;\r\n  gap: 3rem;\r\n  background-color: #131324;\r\n  height:100vh;\r\n  width:100vw;\r\n  .loader{\r\n      max-line-size:100%\r\n  }\r\n  .title-container{\r\n      h1{\r\n          color:white\r\n      }\r\n  }\r\n  .avatars{\r\n      display:flex;\r\n      gap: 2rem;\r\n      .avatar{\r\n          border: 0.4rem solid transparent;\r\n          padding: 0.4rem;\r\n          border-radius: 5rem;\r\n          display:flex;\r\n          justify-content:center;\r\n          align-items:center;\r\n          transition:0.5s ease-in-out;\r\n          img{\r\n            height: 6rem;\r\n          }\r\n      }\r\n      .selected{\r\n          border: 0.4rem solid #4e0eff;\r\n      }\r\n  }\r\n  .submit-btn{\r\n            background-color: #997af0;\r\n            color: white;\r\n            padding: 1rem 2rem;\r\n            border:none ;\r\n            font-weight: bold;\r\n            cursor:pointer;\r\n            border-radius: 0.4rem;\r\n            font-size:1rem;\r\n            text-transform: uppercase;\r\n            transition: 0.5s ease-in-out;\r\n            &:hover{\r\n                background-color: #4e0eff;\r\n            }\r\n  }\r\n`;\r\nexport default SetAvatar"]},"metadata":{},"sourceType":"module"}